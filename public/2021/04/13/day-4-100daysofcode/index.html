<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>Day 4 of 100DaysOfCode - Getting Away from Token Addresses | phil.mk</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 5.4.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Day 4 of 100DaysOfCode - Getting Away from Token Addresses</h1><a id="logo" href="/.">phil.mk</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-user"> About</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Day 4 of 100DaysOfCode - Getting Away from Token Addresses</h1><div class="post-meta">2021-04-13<span> | </span><span class="category"><a href="/categories/development/">development</a></span></div><div class="post-content"><p>Today was spent mostly trying to figure out how to navigate the CoinGecko API a bit more so I could use a token’s symbol instead of its address. </p>
<p>I thought this required first going through the entire list of coins on CoinGecko, looking for the platform, which then gave me the contract address if the token was on Ethereum. I ended up wasting a solid chunk of time because I messed up adding a flag to the end of the address:</p>
<p><code>https://api.coingecko.com/api/v3/coins/list?include_platform=true</code></p>
<p>That being said, this didn’t really matter as I realized that I could instead be pulling the information from the <a target="_blank" rel="noopener" href="https://api.coingecko.com/api/v3/simple/price?ids=litecoin&vs_currencies=usd">/simple/price… page</a>? I’m not entirely sure what to call the different sections of the API. This also led to an issue as the id parameter wants the cryptocurrency’s id, instead of its symbol. While writing out ‘litecoin’ isn’t counter intuitive, it can get a little more messy with something like ‘wrapped-leo.’ Plus, I’d rather enter a token, and then figure out afterwards which API (PancakeSwap or CoinGecko) to pull from.</p>
<p>My convoluted solution involves going through the entire /coins/list, and pulling out the id based on what the user inputs for the symbol:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">coingecko_id_request = requests.get((<span class="string">&#x27;https://api.coingecko.com/api/v3/coins/list?include_platform=true&#x27;</span>))</span><br><span class="line">coingecko_id = coingecko_id_request.json()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> coingecko_id:</span><br><span class="line">    <span class="keyword">if</span> item[<span class="string">&#x27;symbol&#x27;</span>] == <span class="string">&#x27;ltc&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(item[<span class="string">&#x27;id&#x27;</span>])</span><br></pre></td></tr></table></figure>

<p>&gt;&gt;&gt; <code>litecoin</code></p>
<p>So that works, and now it’s just a matter of plugging in ‘litecoin’: </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">coingecko_response = requests.get((<span class="string">&#x27;https://api.coingecko.com/api/v3/simple/price?ids=litecoin&amp;vs_currencies=usd&#x27;</span>))</span><br><span class="line">coingecko_prices = coingecko_response.json()</span><br><span class="line"><span class="built_in">print</span>(coingecko_prices[<span class="string">&#x27;litecoin&#x27;</span>][<span class="string">&#x27;usd&#x27;</span>])</span><br></pre></td></tr></table></figure>

<p>&gt;&gt;&gt; <code>281.7</code></p>
<p>Perfect! Now I just need to put it all together:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pull_coin_gecko_id</span>():</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;Pulls the id after the user inputs a token.&quot;&quot;&quot;</span></span><br><span class="line">    coingecko_id_request = requests.get((<span class="string">&#x27;https://api.coingecko.com/api/v3/coins/list?include_platform=true&#x27;</span>))</span><br><span class="line">    coingecko_id = coingecko_id_request.json() </span><br><span class="line">    <span class="keyword">for</span> crypto_ids <span class="keyword">in</span> coingecko_id:</span><br><span class="line">        <span class="keyword">if</span> crypto_ids[<span class="string">&#x27;symbol&#x27;</span>] == token_input:</span><br><span class="line">            <span class="built_in">print</span>(crypto_ids[<span class="string">&#x27;id&#x27;</span>])</span><br><span class="line">            coingecko_response = requests.get((<span class="string">&#x27;https://api.coingecko.com/api/v3/simple/price?ids=&#x27;</span> + <span class="built_in">str</span>(crypto_ids[<span class="string">&#x27;id&#x27;</span>]) + <span class="string">&#x27;&amp;vs_currencies=usd&#x27;</span>))</span><br><span class="line">            coingecko_prices = coingecko_response.json()</span><br><span class="line">            <span class="built_in">print</span>(coingecko_prices[crypto_ids[<span class="string">&#x27;id&#x27;</span>]][<span class="string">&#x27;usd&#x27;</span>])</span><br></pre></td></tr></table></figure>

<p>So now I have working functions to pull a price from both PancakeSwap and CoinGecko based on user input. My next step is to try and separate out the input request as its own function. This is how I have it mapped out in my head:</p>
<ol>
<li>System requests input.</li>
<li>User inputs ‘ltc’/‘btc’/‘cub’</li>
<li>Function goes through and checks all coins listed on PancakeSwap (as the list is smaller than CoinGeckos)</li>
<li>If listed on PancakeSwap: return the price. Else: check CoinGecko.</li>
</ol>
<p>APIs are bad ass.</p>
<p>I think this should cover almost every token someone would normally look up, but I guess that’ll be something I’ll confirm when I try to actually use it extensively.</p>
</div><div class="tags"><a href="/tags/100daysofcode/"><i class="fa fa-tag"></i>100daysofcode</a></div><div class="post-nav"><a class="pre" href="/2021/04/16/day-5-100daysofcode/">Day 5 of 100DaysOfCode - Handling Inputs</a><a class="next" href="/2021/04/12/day-3-100daysofcode/">Day 3 of 100DaysOfCode - Continuing the Tracker</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://phil.mk"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/development/">development</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/100daysofcode/" style="font-size: 15px;">100daysofcode</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2021/04/16/day-5-100daysofcode/">Day 5 of 100DaysOfCode - Handling Inputs</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/13/day-4-100daysofcode/">Day 4 of 100DaysOfCode - Getting Away from Token Addresses</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/12/day-3-100daysofcode/">Day 3 of 100DaysOfCode - Continuing the Tracker</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/09/day-2-100dayofcode/">Day 2 of 100DaysOfCode - Getting Started with Hexo</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/08/day-1-100daysofcode/">Day 1 of 100DaysOfCode - First Steps</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/08/restarting-the-blog-on-hexo/">Restarting the Blog on Hexo</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2021 <a href="/." rel="nofollow">phil.mk.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><script type="text/javascript" src="/js/copycode.js" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>